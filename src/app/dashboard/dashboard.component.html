<div class="dashboard-layout">
  <h1 class="hidden-title">{{ title }}</h1>
  <aside class="sidebar">
    <div class="logo-area">
      <a routerLink="/dashboard" style="text-decoration: none; color: inherit; display: flex; align-items: center;">
        <span class="logo-icon">‚úîÔ∏è</span>
        <span class="logo-text">TradingThings</span>
      </a>
    </div>
    <ul class="user-list">
      <li><span class="user-icon">üë§</span> {{ username }}</li>
      <!--li *ngIf="userRole !== null" class="user-role">Rol: {{ getRoleLabel() }}</li-->
    </ul>
    <div class="sidebar-links">
      <nav>
        <ul>
          <li><a routerLink="/publicar-producto">Publicar productos</a></li>
          <li><a routerLink="/dashboard/mis-productos">Mis productos</a></li>
          <li><a routerLink="/favoritos">Favoritos</a></li>
          <li><a routerLink="/historial">Historial</a></li>
        </ul>
      </nav>
    </div>
    <div class="sidebar-footer">
      <div class="social-icons">
        <span><i class="fa fa-facebook"></i></span>
        <span><i class="fa fa-instagram"></i></span>
        <span><i class="fa fa-twitter"></i></span>
      </div>
      <div class="phone">Tel√©fono: 123-456-7890</div>
      <button class="logout-btn" (click)="logout()">
        <i class="fa fa-sign-out"></i> Cerrar Sesi√≥n
      </button>
    </div>
  </aside>

  <div class="main-content">
    <header class="main-header">
      <div class="welcome-message">
        <h2>Bienvenido, {{ username }}!</h2>
        <!--p *ngIf="userRole !== null">Rol: {{ getRoleLabel() }}</p-->
      </div>
      <div class="user-info">
        <span>{{ username }}</span>
        <span class="user-avatar"><i class="fa fa-user"></i></span>
        <!--span class="user-role-label">{{ getRoleLabel() }}</span-->
      </div>
    </header>

    <!-- Router outlet for child routes -->
    <router-outlet></router-outlet>

    <!-- Dashboard content - only show when no child route is active -->
    <div *ngIf="!hasActiveChildRoute()">
      <!-- Only show publish button and products grid if NOT admin -->
      <div *ngIf="!isAdmin()">
        <div class="publish-btn-area">
          <button class="publish-btn" routerLink="/publicar-producto">Publicar producto</button>
        </div>
        <div class="products-grid">
          <div *ngIf="loadingProducts" class="loading">Cargando publicaciones...</div>
          <div *ngIf="errorProducts" class="error">{{ errorProducts }}</div>
          <div class="product-card" *ngFor="let product of products">
            <img *ngIf="product.imagenUrl" [src]="product.imagenUrl" [alt]="product.titulo">
            <div class="product-title">{{ product.titulo }}</div>
            <a class="see-more-btn" [routerLink]="['/dashboard/producto', product.id]">Ver m√°s</a>
          </div>
        </div>
      </div>

      <!-- Only show user list if admin -->
      <app-users-list *ngIf="isAdmin()"></app-users-list>
    </div>
  </div>
</div>
