import{a as J,c as K,f as Q,p as X}from"./chunk-MUP63TIL.js";import{a as Z}from"./chunk-54KZWHWX.js";import{$ as U,A as C,B as D,F as _,Ga as v,Ha as q,I as l,Ia as G,J as w,L as r,M as o,N as O,O as y,P as S,Q as b,R as g,S as s,V as d,W as f,X as x,Z as V,_ as A,ba as T,da as F,ea as z,ga as $,na as B,oa as N,p as u,pa as j,q as p,ra as R,sa as H,ua as h,va as W,x as k,xa as L,y as a,za as Y}from"./chunk-M6YUWBB5.js";import{a as I,b as M,f as E}from"./chunk-42NE2CY3.js";var it=(n,e)=>({"estado-publicado":n,"estado-aprobado":e}),et=()=>[1,2,3,4,5];function ot(n,e){n&1&&(r(0,"div",8),d(1,"Cargando producto..."),o())}function rt(n,e){if(n&1&&(r(0,"div",9),d(1),o()),n&2){let t=s();a(),f(t.error)}}function at(n,e){n&1&&(r(0,"span",21),d(1,"\u2705"),o())}function ct(n,e){n&1&&(r(0,"span",29),d(1,"Guardando..."),o())}function dt(n,e){if(n&1&&(r(0,"span",30),d(1),o()),n&2){let t=s(3);a(),f(t.estadoError)}}function st(n,e){if(n&1){let t=b();y(0),r(1,"span",22),d(2,"Borrador"),o(),r(3,"label",23)(4,"input",24),g("change",function(c){u(t);let m=s(2);return p(m.onToggleEstado(c))}),o(),O(5,"span",25),o(),r(6,"span",26),d(7,"Publicado"),o(),_(8,ct,2,0,"span",27)(9,dt,2,1,"span",28),S()}if(n&2){let t=s(2);a(4),l("checked",t.esPublicado())("disabled",t.cambiandoEstado),a(4),l("ngIf",t.cambiandoEstado),a(),l("ngIf",t.estadoError)}}function lt(n,e){if(n&1&&(y(0),r(1,"span",31),d(2),o(),S()),n&2){let t=s(2);a(),l("ngClass",F(2,it,((t.product==null||t.product.estado==null?null:t.product.estado.estado)||(t.product==null?null:t.product.estado))==="Publicado",((t.product==null||t.product.estado==null?null:t.product.estado.estado)||(t.product==null||t.product.estado==null?null:t.product.estado.nombre)||(t.product==null?null:t.product.estado))==="Aprobado"||((t.product==null||t.product.estado==null?null:t.product.estado.estado)||(t.product==null||t.product.estado==null?null:t.product.estado.nombre)||(t.product==null?null:t.product.estado))==="APROBADO")),a(),x(" ",(t.product==null||t.product.estado==null?null:t.product.estado.estado)||(t.product==null||t.product.estado==null?null:t.product.estado.nombre)||(t.product==null?null:t.product.estado)||"Sin estado"," ")}}function mt(n,e){if(n&1){let t=b();r(0,"div",32)(1,"button",33),g("click",function(){u(t);let c=s(2);return p(c.openIntercambioModal())}),d(2," \u{1F504} Intercambiar Producto "),o()()}}function ut(n,e){n&1&&(r(0,"div",34)(1,"span",35),d(2,"\u2705"),o(),r(3,"span"),d(4,"Ya fue intercambiado"),o()())}function pt(n,e){if(n&1&&(r(0,"div",10)(1,"div",11),O(2,"img",12),_(3,at,2,0,"span",13),o(),r(4,"div",14)(5,"div",15),d(6),o(),r(7,"div",16),d(8),o(),r(9,"div",17)(10,"strong"),d(11,"Precio:"),o(),d(12),z(13,"currency"),o(),r(14,"div",17)(15,"strong"),d(16,"Estado:"),o(),_(17,st,10,4,"ng-container",18)(18,lt,3,5,"ng-container",18),o(),r(19,"div",17)(20,"strong"),d(21,"Autor:"),o(),d(22),o(),_(23,mt,3,0,"div",19)(24,ut,5,0,"div",20),o()()),n&2){let t=s();a(2),l("src",t.product.urlFoto||"assets/no-image.png",k)("alt",t.product.titulo),a(),l("ngIf",t.product&&(t.product.estado==="Aprobado"||t.product.estado==="APROBADO"||(t.product.estado==null?null:t.product.estado.nombre)==="Aprobado"||(t.product.estado==null?null:t.product.estado.nombre)==="APROBADO"||(t.product.estado==null?null:t.product.estado.estado)==="Aprobado"||(t.product.estado==null?null:t.product.estado.estado)==="APROBADO")),a(3),f(t.product.titulo),a(2),f(t.product.descripcion),a(4),x(" ",$(13,11,t.product.precio,"USD","symbol","1.0-0"),""),a(5),l("ngIf",t.puedeEditarEstado()),a(),l("ngIf",!t.puedeEditarEstado()),a(4),x(" ",t.autorNombre,""),a(),l("ngIf",t.canShowIntercambioButton()),a(),l("ngIf",(t.product==null?null:t.product.estado)==="APROBADO")}}function gt(n,e){if(n&1){let t=b();r(0,"span",49),g("click",function(){let c=u(t).$implicit,m=s(2);return p(m.newComment.valoracion=c)}),d(1),o()}if(n&2){let t=e.$implicit,i=s(2);w("selected",t<=i.newComment.valoracion),a(),x(" ",t<=i.newComment.valoracion?"\u2605":"\u2606"," ")}}function _t(n,e){if(n&1&&(r(0,"div",30),d(1),o()),n&2){let t=s(2);a(),f(t.commentError)}}function ft(n,e){n&1&&(r(0,"div",8),d(1,"Cargando comentarios..."),o())}function xt(n,e){n&1&&(r(0,"div",50),d(1," No hay comentarios a\xFAn. \xA1S\xE9 el primero en comentar! "),o())}function bt(n,e){if(n&1&&(r(0,"span",61),d(1),o()),n&2){let t=e.$implicit;a(),f(t)}}function ht(n,e){if(n&1&&(r(0,"div",62),d(1),o()),n&2){let t=s().$implicit;a(),f(t.texto)}}function vt(n,e){if(n&1){let t=b();r(0,"span",49),g("click",function(){let c=u(t).$implicit,m=s(4);return p(m.editedComment.valoracion=c)}),d(1),o()}if(n&2){let t=e.$implicit,i=s(4);w("selected",t<=i.editedComment.valoracion),a(),f(t<=i.editedComment.valoracion?"\u2605":"\u2606")}}function Ct(n,e){if(n&1){let t=b();r(0,"div",63)(1,"textarea",64),U("ngModelChange",function(c){u(t);let m=s(3);return A(m.editedComment.texto,c)||(m.editedComment.texto=c),p(c)}),o(),r(2,"div",65),_(3,vt,2,3,"span",43),r(4,"span",44),d(5),o()(),r(6,"div",66)(7,"button",67),g("click",function(){u(t);let c=s().$implicit,m=s(2);return p(m.guardarEdicionComentario(c))}),r(8,"span",68),d(9,"\u{1F4BE}"),o(),d(10,"Guardar"),o(),r(11,"button",69),g("click",function(){u(t);let c=s(3);return p(c.cancelarEdicionComentario())}),r(12,"span",68),d(13,"\u2716\uFE0F"),o(),d(14,"Cancelar"),o()()()}if(n&2){let t=s(3);a(),V("ngModel",t.editedComment.texto),a(2),l("ngForOf",T(3,et)),a(2),x("",t.editedComment.valoracion,"/5")}}function Pt(n,e){if(n&1){let t=b();r(0,"div",70)(1,"button",67),g("click",function(){u(t);let c=s().$implicit,m=s(2);return p(m.editarComentario(c))}),r(2,"span",68),d(3,"\u270F\uFE0F"),o(),d(4,"Editar"),o(),r(5,"button",69),g("click",function(){u(t);let c=s().$implicit,m=s(2);return p(m.borrarComentario(c.id))}),r(6,"span",68),d(7,"\u{1F5D1}\uFE0F"),o(),d(8,"Borrar"),o()()}}function wt(n,e){if(n&1&&(r(0,"div",51)(1,"div",52)(2,"div",53),d(3),o(),r(4,"div",54),d(5),o()(),r(6,"div",55),_(7,bt,2,1,"span",56),r(8,"span",57),d(9),o()(),_(10,ht,2,1,"div",58)(11,Ct,15,4,"div",59)(12,Pt,9,0,"div",60),o()),n&2){let t=e.$implicit,i=s(2);a(3),f(i.getNombreAutorComentario(t.idAutor)),a(2),f(i.formatDate(t.fechaCreacion)),a(2),l("ngForOf",i.getStars(t.valoracion)),a(2),x("",t.valoracion,"/5"),a(),l("ngIf",i.editingCommentId!==t.id),a(),l("ngIf",i.isAdmin()&&i.editingCommentId===t.id),a(),l("ngIf",i.isAdmin()&&i.editingCommentId!==t.id)}}function Ot(n,e){if(n&1){let t=b();r(0,"div",36)(1,"h3",37),d(2),o(),r(3,"div",38)(4,"h4"),d(5,"Agregar Comentario"),o(),r(6,"div",39)(7,"label",40),d(8,"Tu comentario:"),o(),r(9,"textarea",41),U("ngModelChange",function(c){u(t);let m=s();return A(m.newComment.texto,c)||(m.newComment.texto=c),p(c)}),d(10,"        "),o()(),r(11,"div",39)(12,"label"),d(13,"Valoraci\xF3n:"),o(),r(14,"div",42),_(15,gt,2,3,"span",43),r(16,"span",44),d(17),o()()(),_(18,_t,2,1,"div",28),r(19,"button",45),g("click",function(){u(t);let c=s();return p(c.submitComment())}),d(20),o()(),r(21,"div",46),_(22,ft,2,0,"div",3)(23,xt,2,0,"div",47)(24,wt,13,7,"div",48),o()()}if(n&2){let t=s();a(2),x("Comentarios (",t.comments.length,")"),a(7),V("ngModel",t.newComment.texto),l("disabled",t.submittingComment),a(6),l("ngForOf",T(11,et)),a(2),x("",t.newComment.valoracion,"/5"),a(),l("ngIf",t.commentError),a(),l("disabled",t.submittingComment||!t.newComment.texto.trim()),a(),x(" ",t.submittingComment?"Enviando...":"Enviar Comentario"," "),a(2),l("ngIf",t.loadingComments),a(),l("ngIf",!t.loadingComments&&t.comments.length===0),a(),l("ngForOf",t.comments)}}function It(n,e){n&1&&(r(0,"div",8),d(1," Cargando tus productos... "),o())}function Mt(n,e){n&1&&(r(0,"div",81),d(1," No tienes productos publicados para intercambiar. "),o())}function Et(n,e){if(n&1){let t=b();r(0,"div",84),g("click",function(){let c=u(t).$implicit,m=s(3);return p(m.selectedProductId=c.id)}),O(1,"img",12),r(2,"div",14)(3,"h4"),d(4),o(),r(5,"p"),d(6),o(),r(7,"p",85),d(8),z(9,"currency"),o()()()}if(n&2){let t=e.$implicit,i=s(3);w("selected",i.selectedProductId===t.id),a(),l("src",t.urlFoto||"assets/no-image.png",k)("alt",t.titulo),a(3),f(t.titulo),a(2),f(t.descripcion),a(2),f($(9,7,t.precio,"USD","symbol","1.0-0"))}}function kt(n,e){if(n&1&&(r(0,"div",82),_(1,Et,10,12,"div",83),o()),n&2){let t=s(2);a(),l("ngForOf",t.userProducts)}}function yt(n,e){if(n&1&&(r(0,"div",30),d(1),o()),n&2){let t=s(2);a(),x(" ",t.intercambioError," ")}}function St(n,e){if(n&1){let t=b();r(0,"div",71),g("click",function(){u(t);let c=s();return p(c.closeIntercambioModal())}),r(1,"div",72),g("click",function(c){return u(t),p(c.stopPropagation())}),r(2,"div",73)(3,"h3"),d(4,"Intercambiar Producto"),o(),r(5,"button",74),g("click",function(){u(t);let c=s();return p(c.closeIntercambioModal())}),d(6,"\xD7"),o()(),r(7,"div",75)(8,"p"),d(9),o(),_(10,It,2,0,"div",3)(11,Mt,2,0,"div",76)(12,kt,2,1,"div",77)(13,yt,2,1,"div",28),o(),r(14,"div",78)(15,"button",79),g("click",function(){u(t);let c=s();return p(c.closeIntercambioModal())}),d(16,"Cancelar"),o(),r(17,"button",80),g("click",function(){u(t);let c=s();return p(c.submitIntercambio())}),d(18),o()()()()}if(n&2){let t=s();a(9),x('Selecciona uno de tus productos para intercambiar con "',t.product.titulo,'":'),a(),l("ngIf",t.loadingUserProducts),a(),l("ngIf",!t.loadingUserProducts&&t.userProducts.length===0),a(),l("ngIf",!t.loadingUserProducts&&t.userProducts.length>0),a(),l("ngIf",t.intercambioError),a(4),l("disabled",!t.selectedProductId||t.submittingIntercambio),a(),x(" ",t.submittingIntercambio?"Enviando...":"Enviar Oferta"," ")}}var tt=class n{constructor(e,t,i,c,m,P){this.route=e;this.http=t;this.router=i;this.userService=c;this.authService=m;this.apiService=P}product=null;comments=[];loading=!0;loadingComments=!1;error=null;commentError=null;autorNombre=null;mapaUsuarios={};currentUserId=null;newComment={texto:"",valoracion:5};submittingComment=!1;editingCommentId=null;editedComment={texto:"",valoracion:5};showIntercambioModal=!1;userProducts=[];selectedProductId=null;loadingUserProducts=!1;intercambioError=null;submittingIntercambio=!1;cambiandoEstado=!1;estadoError=null;ngOnInit(){return E(this,null,function*(){let e=this.route.snapshot.paramMap.get("id");if(!e){this.error="ID de producto no especificado.",this.loading=!1;return}yield this.setCurrentUserId(),this.loadProduct(e),this.loadComments(e)})}setCurrentUserId(){return E(this,null,function*(){let e=this.authService.getUserInfo(),t=e?.email||Array.isArray(e?.emails)&&e.emails[0]||void 0;if(t)try{let i=yield this.userService.getUsuarioIdPorCorreo(t);this.currentUserId=i}catch{this.currentUserId=null}else this.currentUserId=null})}loadProduct(e){let t=localStorage.getItem("token"),i=t?new h({Authorization:`Bearer ${t}`}):void 0;this.http.get(`${v.publicacionesApiUrl}/publicaciones/${e}`,{headers:i}).subscribe({next:c=>{this.product=c,this.loading=!1,this.loadAutorNombre()},error:c=>{this.error="Error al cargar el producto.",this.loading=!1}})}loadAutorNombre(){if(!this.product||!this.product.idAutor){this.autorNombre=null;return}this.userService.getUsuarioPorId(this.product.idAutor).then(e=>{e?this.autorNombre=`${e.primerNombre} ${e.apellidoPaterno}`:this.autorNombre=`Usuario ${this.product.idAutor}`}).catch(()=>{this.autorNombre=`Usuario ${this.product.idAutor}`})}loadComments(e){this.loadingComments=!0;let t=localStorage.getItem("token"),i=t?new h({Authorization:`Bearer ${t}`}):void 0;this.http.get(`${v.publicacionesApiUrl}/comentarios/publicacion/${e}`,{headers:i}).subscribe({next:c=>{this.comments=c,this.loadingComments=!1,this.loadAutoresComentarios()},error:c=>{this.commentError="Error al cargar los comentarios.",this.loadingComments=!1}})}loadAutoresComentarios(){Array.from(new Set(this.comments.map(t=>t.idAutor))).forEach(t=>{this.mapaUsuarios[t]||this.userService.getUsuarioPorId(t).then(i=>{i?this.mapaUsuarios[t]=`${i.primerNombre} ${i.apellidoPaterno}`:this.mapaUsuarios[t]=`Usuario ${t}`}).catch(()=>{this.mapaUsuarios[t]=`Usuario ${t}`})})}submitComment(){if(!this.newComment.texto.trim()){this.commentError="El comentario no puede estar vac\xEDo.";return}if(!this.currentUserId){this.commentError="No se pudo obtener el usuario actual. Intenta recargar la p\xE1gina.";return}this.submittingComment=!0,this.commentError=null;let e={texto:this.newComment.texto,valoracion:this.newComment.valoracion,idPublicacion:this.product.id,idAutor:this.currentUserId},t=localStorage.getItem("token"),i=t?new h({Authorization:`Bearer ${t}`}):void 0;this.http.post(`${v.publicacionesApiUrl}/comentarios`,e,{headers:i}).subscribe({next:c=>{this.comments.push(c),this.loadAutoresComentarios(),this.newComment={texto:"",valoracion:5},this.submittingComment=!1},error:c=>{this.commentError="Error al crear el comentario.",this.submittingComment=!1}})}getNombreAutorComentario(e){return this.mapaUsuarios[e]||`Usuario ${e}`}getStars(e){let t=[];for(let i=1;i<=5;i++)t.push(i<=e?"\u2605":"\u2606");return t}formatDate(e){return new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}goBackToUserProducts(){this.router.navigate(["/dashboard/mis-productos"])}isAdmin(){let e=this.userService.getRol();return!!(typeof e=="number"&&e===1||typeof e=="object"&&e&&e.id===1)}borrarComentario(e){if(this.isAdmin()&&confirm("\xBFSeguro que deseas borrar este comentario?")){let t=localStorage.getItem("token"),i=t?new h({Authorization:`Bearer ${t}`}):void 0;this.http.delete(`${v.publicacionesApiUrl}/comentarios/${e}`,{headers:i}).subscribe({next:()=>{this.comments=this.comments.filter(c=>c.id!==e),alert("Comentario eliminado correctamente")},error:()=>alert("Error al eliminar el comentario")})}}editarComentario(e){this.isAdmin()&&(this.editingCommentId=e.id,this.editedComment={texto:e.texto,valoracion:e.valoracion})}cancelarEdicionComentario(){this.editingCommentId=null,this.editedComment={texto:"",valoracion:5}}guardarEdicionComentario(e){if(!this.isAdmin())return;let t=localStorage.getItem("token"),i=t?new h({Authorization:`Bearer ${t}`}):void 0,c=M(I({},e),{texto:this.editedComment.texto,valoracion:this.editedComment.valoracion});this.http.put(`${v.publicacionesApiUrl}/comentarios/${e.id}`,c,{headers:i}).subscribe({next:m=>{let P=this.comments.findIndex(nt=>nt.id===e.id);P!==-1&&(this.comments[P]=m),this.cancelarEdicionComentario(),alert("Comentario editado correctamente")},error:()=>alert("Error al editar el comentario")})}isProductOwner(){return this.currentUserId===this.product?.idAutor}canShowIntercambioButton(){return this.currentUserId&&this.product&&!this.isProductOwner()&&this.product.estado?.nombre==="Publicado"||this.product.estado==="Publicado"}openIntercambioModal(){if(!this.currentUserId){alert("Debes iniciar sesi\xF3n para realizar intercambios");return}this.showIntercambioModal=!0,this.loadUserProducts()}closeIntercambioModal(){this.showIntercambioModal=!1,this.selectedProductId=null,this.intercambioError=null}loadUserProducts(){this.loadingUserProducts=!0,this.intercambioError=null;let e=localStorage.getItem("token"),t=e?new h({Authorization:`Bearer ${e}`}):void 0;this.http.get(`${v.publicacionesApiUrl}/publicaciones/usuario/${this.currentUserId}`,{headers:t}).subscribe({next:i=>{this.userProducts=i.filter(c=>c.estado?.nombre==="Publicado"||c.estado==="Publicado"),this.loadingUserProducts=!1},error:i=>{this.intercambioError="Error al cargar tus productos",this.loadingUserProducts=!1}})}submitIntercambio(){if(!this.selectedProductId){this.intercambioError="Debes seleccionar un producto para intercambiar";return}this.submittingIntercambio=!0,this.intercambioError=null;let e={idProductoSolicitado:this.product.id,idProductoOfrecido:this.selectedProductId,idUsuarioSolicitante:this.currentUserId,idUsuarioPropietario:this.product.idAutor};this.apiService.crearOfertaIntercambio(e).subscribe({next:t=>{alert("Oferta de intercambio enviada correctamente"),this.closeIntercambioModal(),this.submittingIntercambio=!1},error:t=>{this.intercambioError=t.error||"Error al enviar la oferta de intercambio",this.submittingIntercambio=!1}})}puedeEditarEstado(){return this.currentUserId===this.product?.idAutor&&this.product?.estado?.nombre!=="Aprobado"&&this.product?.estado!=="Aprobado"}esPublicado(){return this.product?.estado?.nombre==="Publicado"||this.product?.estado==="Publicado"}cambiarEstadoPublicacion(e){if(!this.puedeEditarEstado()||this.cambiandoEstado)return;this.cambiandoEstado=!0,this.estadoError=null;let t=e==="Publicado"?1:2,i=M(I({},this.product),{estado:{id:t}}),c=localStorage.getItem("token"),m=c?{headers:new h({Authorization:`Bearer ${c}`})}:{};this.http.put(`${v.publicacionesApiUrl}/publicaciones/${this.product.id}`,i,m).subscribe({next:P=>{this.product.estado=P.estado,this.cambiandoEstado=!1},error:P=>{this.estadoError="Error al cambiar el estado",this.cambiandoEstado=!1}})}onToggleEstado(e){let t=e.target.checked;this.cambiarEstadoPublicacion(t?"Publicado":"Borrador")}static \u0275fac=function(t){return new(t||n)(C(L),C(W),C(Y),C(G),C(q),C(Z))};static \u0275cmp=D({type:n,selectors:[["app-product-view"]],decls:9,vars:5,consts:[[1,"product-view-card","unified-product-card"],[1,"product-view-header"],[1,"product-view-title"],["class","loading",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],["class","product-detail-unified",4,"ngIf"],["class","comments-section",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"loading"],["role","alert",1,"alert","alert-danger"],[1,"product-detail-unified"],[1,"product-image"],[3,"src","alt"],["class","ticket-verde-imagen",4,"ngIf"],[1,"product-info"],[1,"product-title-main"],[1,"product-description-subtitle"],[1,"product-detail-row"],[4,"ngIf"],["class","intercambio-section",4,"ngIf"],["class","intercambiado-info",4,"ngIf"],[1,"ticket-verde-imagen"],[1,"toggle-label","toggle-label-left"],[1,"switch-estado"],["type","checkbox",3,"change","checked","disabled"],[1,"slider"],[1,"toggle-label"],["class","estado-spinner",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"estado-spinner"],[1,"error-message"],[3,"ngClass"],[1,"intercambio-section"],[1,"intercambio-btn",3,"click"],[1,"intercambiado-info"],[1,"ticket-verde"],[1,"comments-section"],[1,"comments-title"],[1,"new-comment-form"],[1,"form-group"],["for","commentText"],["id","commentText","placeholder","Escribe tu comentario aqu\xED...","rows","3",1,"comment-textarea",3,"ngModelChange","ngModel","disabled"],[1,"rating-stars"],["class","star",3,"selected","click",4,"ngFor","ngForOf"],[1,"rating-text"],[1,"submit-comment-btn",3,"click","disabled"],[1,"comments-list"],["class","no-comments",4,"ngIf"],["class","comment-item",4,"ngFor","ngForOf"],[1,"star",3,"click"],[1,"no-comments"],[1,"comment-item"],[1,"comment-header"],[1,"comment-author"],[1,"comment-date"],[1,"comment-rating"],["class","star-display",4,"ngFor","ngForOf"],[1,"rating-text-display"],["class","comment-text",4,"ngIf"],["class","edit-comment-inline",4,"ngIf"],["class","admin-comment-actions",4,"ngIf"],[1,"star-display"],[1,"comment-text"],[1,"edit-comment-inline"],["rows","2",1,"edit-comment-textarea",3,"ngModelChange","ngModel"],[1,"edit-rating-stars"],[1,"edit-actions"],[1,"edit-btn",3,"click"],[1,"icon"],[1,"delete-btn",3,"click"],[1,"admin-comment-actions"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],["class","no-products",4,"ngIf"],["class","products-grid",4,"ngIf"],[1,"modal-footer"],[1,"cancel-btn",3,"click"],[1,"submit-btn",3,"click","disabled"],[1,"no-products"],[1,"products-grid"],["class","product-option",3,"selected","click",4,"ngFor","ngForOf"],[1,"product-option",3,"click"],[1,"price"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2),d(3,"Detalle del Producto"),o()(),_(4,ot,2,0,"div",3)(5,rt,2,1,"div",4)(6,pt,25,16,"div",5)(7,Ot,25,12,"div",6)(8,St,19,7,"div",7),o()),t&2&&(a(4),l("ngIf",i.loading),a(),l("ngIf",i.error),a(),l("ngIf",!i.loading&&!i.error&&i.product),a(),l("ngIf",!i.loading&&!i.error&&i.product),a(),l("ngIf",i.showIntercambioModal))},dependencies:[H,B,N,j,R,X,J,K,Q],styles:['.product-view-card[_ngcontent-%COMP%]{max-width:950px;margin:48px auto;background:#fff;border-radius:16px;box-shadow:0 2px 16px #22314a1a;padding:2.5rem 2rem 2rem;display:flex;flex-direction:column;align-items:center}.unified-product-card[_ngcontent-%COMP%]{max-width:950px;width:100%;padding:2.5rem 2.5rem 2rem}.product-detail-unified[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:3.5rem;width:100%;background:#fff;border-radius:16px;box-shadow:0 2px 12px #00000014;padding:2.5rem;margin:2rem 0}.product-image[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-width:240px;min-height:240px;background:#f7f8fa;border-radius:12px;box-shadow:0 2px 8px #00000012;position:relative}.product-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:220px;max-height:220px;border-radius:12px;object-fit:cover;box-shadow:0 2px 8px #0000001a}.product-info[_ngcontent-%COMP%]{background:#f7f8fa;border-radius:12px;padding:2rem 2.5rem;display:flex;flex-direction:column;gap:1.2rem;min-width:320px;max-width:500px;width:100%;justify-content:center}.product-title-main[_ngcontent-%COMP%]{font-size:1.7rem;font-weight:700;color:#1a237e;margin-bottom:1.2rem;text-align:left}.product-detail-row[_ngcontent-%COMP%]{font-size:1.08rem;font-weight:500;background:#fff;border-radius:8px;padding:.7rem 1.2rem;margin-bottom:.5rem;box-shadow:0 1px 4px #0000000a;display:flex;align-items:center;gap:.7rem;width:100%;min-height:40px;text-align:left;word-break:break-word}.estado-publicado[_ngcontent-%COMP%], .estado-aprobado[_ngcontent-%COMP%]{color:#2ecc40!important;font-weight:700;background:none!important}.back-btn[_ngcontent-%COMP%]{background:#22304a;color:#fff;border:none;border-radius:6px;padding:.5rem 1.2rem;margin-bottom:1.2rem;font-weight:500;font-size:1rem;cursor:pointer;transition:background .2s}.back-btn[_ngcontent-%COMP%]:hover{background:#1a2333}.product-view-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.top-btn[_ngcontent-%COMP%]{display:block;margin:.5rem auto 1.5rem}.comments-section[_ngcontent-%COMP%]{width:100%;max-width:700px;margin-top:2rem;background:#fff;border-radius:16px;box-shadow:0 2px 12px #00000014;padding:2rem}.comments-title[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:600;color:#1a237e;margin-bottom:1.5rem;text-align:center}.new-comment-form[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:12px;padding:1.5rem;margin-bottom:2rem;border:1px solid #e9ecef}.new-comment-form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#495057;margin-bottom:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;color:#495057;margin-bottom:.5rem}.comment-textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #ced4da;border-radius:6px;font-size:.95rem;resize:vertical;min-height:80px;font-family:inherit}.comment-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#1a237e;box-shadow:0 0 0 2px #1a237e1a}.rating-stars[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.star[_ngcontent-%COMP%]{font-size:1.5rem;color:#ffc107;cursor:pointer;transition:transform .1s;-webkit-user-select:none;user-select:none}.star[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.star.selected[_ngcontent-%COMP%]{color:#ff9800}.rating-text[_ngcontent-%COMP%]{font-weight:500;color:#495057;margin-left:.5rem}.submit-comment-btn[_ngcontent-%COMP%]{background:#1a237e;color:#fff;border:none;border-radius:6px;padding:.75rem 1.5rem;font-weight:500;font-size:.95rem;cursor:pointer;transition:background .2s;margin-top:.5rem}.submit-comment-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#0d47a1}.submit-comment-btn[_ngcontent-%COMP%]:disabled{background:#9fa8da;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{color:#d32f2f;background:#ffebee;padding:.75rem;border-radius:4px;margin:.5rem 0;border-left:4px solid #d32f2f;font-size:.9rem}.comments-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.no-comments[_ngcontent-%COMP%]{text-align:center;color:#6c757d;font-style:italic;padding:2rem;background:#f8f9fa;border-radius:8px;border:1px dashed #dee2e6}.comment-item[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:8px;padding:1rem;border-left:4px solid #1a237e}.comment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.comment-author[_ngcontent-%COMP%]{font-weight:600;color:#495057;font-size:.9rem}.comment-date[_ngcontent-%COMP%]{color:#6c757d;font-size:.8rem}.comment-rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;margin-bottom:.5rem}.star-display[_ngcontent-%COMP%]{font-size:1rem;color:#ffc107}.rating-text-display[_ngcontent-%COMP%]{font-size:.8rem;color:#6c757d;margin-left:.25rem}.comment-text[_ngcontent-%COMP%]{color:#495057;line-height:1.5;font-size:.95rem}.product-description-block[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1rem 1.2rem;margin-bottom:.7rem;box-shadow:0 1px 4px #0000000a;font-size:1.08rem;font-weight:500;width:100%;min-height:48px;text-align:left;word-break:break-word;white-space:pre-line;display:flex;align-items:flex-start;gap:.5rem}.product-description-subtitle[_ngcontent-%COMP%]{font-size:1.13rem;color:#495057;margin-bottom:1.1rem;margin-top:-.5rem;width:100%;white-space:pre-line;font-weight:400;line-height:1.5}.admin-comment-actions[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:6px}.edit-btn[_ngcontent-%COMP%]{background-color:#1976d2;color:#fff;border:none;border-radius:4px;padding:5px 12px;cursor:pointer;font-size:13px;display:flex;align-items:center;transition:background .2s}.edit-btn[_ngcontent-%COMP%]:hover{background-color:#125ea2}.delete-btn[_ngcontent-%COMP%]{background-color:#e53935;color:#fff;border:none;border-radius:4px;padding:5px 12px;cursor:pointer;font-size:13px;display:flex;align-items:center;transition:background .2s}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#b71c1c}.edit-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin-right:5px}.intercambio-section[_ngcontent-%COMP%]{margin-top:1.5rem;text-align:center}.intercambio-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;padding:.8rem 1.5rem;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #667eea4d}.intercambio-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 16px #667eea66}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:16px;width:90%;max-width:600px;max-height:80vh;overflow-y:auto;box-shadow:0 10px 30px #0000004d}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 2rem;border-bottom:1px solid #e9ecef}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#1a237e;font-size:1.3rem;font-weight:600}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#6c757d;padding:0;width:30px;height:30px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background .2s}.close-btn[_ngcontent-%COMP%]:hover{background:#f8f9fa}.modal-body[_ngcontent-%COMP%]{padding:2rem}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1.5rem;color:#495057;font-size:1rem}.products-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:2rem;margin-bottom:1.5rem}.product-option[_ngcontent-%COMP%]{border:2px solid #e9ecef;border-radius:16px;padding:1.3rem 1.2rem;cursor:pointer;transition:all .3s ease;background:#fff;display:flex;align-items:center;gap:1.2rem;min-height:90px}.product-option[_ngcontent-%COMP%]:hover{border-color:#667eea;transform:translateY(-2px);box-shadow:0 4px 12px #667eea26}.product-option.selected[_ngcontent-%COMP%]{border-color:#667eea;background:#f8f9ff;box-shadow:0 4px 12px #667eea33}.product-option[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:110px;object-fit:cover;border-radius:12px;margin-bottom:0;border:2.5px solid #e9ecef;transition:border-color .3s;flex-shrink:0}.product-option[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;gap:.2rem}.product-option[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1rem;color:#1a237e;font-weight:600}.product-option[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.3rem 0;font-size:.9rem;color:#6c757d}.product-option[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-weight:600;color:#28a745;font-size:1rem}.no-products[_ngcontent-%COMP%]{text-align:center;color:#6c757d;font-style:italic;padding:2rem}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;padding:1.5rem 2rem;border-top:1px solid #e9ecef}.cancel-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;border-radius:6px;padding:.7rem 1.2rem;font-size:.95rem;cursor:pointer;transition:background .2s}.cancel-btn[_ngcontent-%COMP%]:hover{background:#5a6268}.submit-btn[_ngcontent-%COMP%]{background:#28a745;color:#fff;border:none;border-radius:6px;padding:.7rem 1.2rem;font-size:.95rem;font-weight:600;cursor:pointer;transition:background .2s}.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838}.submit-btn[_ngcontent-%COMP%]:disabled{background:#6c757d;cursor:not-allowed}.switch-estado[_ngcontent-%COMP%]{position:relative;display:inline-block;width:48px;height:26px;margin-left:1rem;vertical-align:middle}.switch-estado[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:26px}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:20px;width:20px;left:3px;bottom:3px;background-color:#fff;transition:.4s;border-radius:50%}.switch-estado[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#2b3}.switch-estado[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(22px)}.toggle-label[_ngcontent-%COMP%]{margin-left:.7rem;font-weight:600;color:#1a237e}.toggle-label-left[_ngcontent-%COMP%]{margin-right:.7rem;font-weight:600;color:#1a237e}.estado-spinner[_ngcontent-%COMP%]{margin-left:1rem;color:#1976d2;font-size:.95rem}.intercambiado-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:green;font-weight:700;margin-top:10px}.ticket-verde[_ngcontent-%COMP%]{font-size:1.5em}.ticket-verde-imagen[_ngcontent-%COMP%]{font-size:2em;color:#2ecc40;position:absolute;top:10px;right:10px;background:transparent;border-radius:50%;padding:2px 6px;box-shadow:none}.aprobado-label[_ngcontent-%COMP%]{color:#2ecc40;font-weight:700;font-size:1.2em;margin-top:4px;text-align:right;width:100%}@media (max-width: 600px){.products-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1.2rem}.product-option[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;min-height:110px}.product-option[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-bottom:.5rem}}']})};export{tt as ProductViewComponent};
