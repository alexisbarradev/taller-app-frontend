import{A as c,Aa as S,B as x,Ca as E,F as p,Ga as M,Ha as k,I as s,Ia as A,L as a,M as i,N as h,S as g,V as d,W as l,X as b,ca as _,ea as C,ga as P,oa as O,pa as w,ra as y,sa as I,va as U,x as v,y as n}from"./chunk-M6YUWBB5.js";import{f}from"./chunk-42NE2CY3.js";var z=t=>["/dashboard/producto",t];function D(t,r){t&1&&(a(0,"div",6),d(1,"Cargando productos..."),i())}function F(t,r){if(t&1&&(a(0,"div",7),d(1),i()),t&2){let e=g();n(),l(e.error)}}function N(t,r){t&1&&(a(0,"div",8),d(1," No tienes productos publicados. "),i())}function j(t,r){t&1&&(a(0,"span",19),d(1,"\u2705"),i())}function B(t,r){if(t&1&&(a(0,"div",11)(1,"div",12),h(2,"img",13),p(3,j,2,0,"span",14),i(),a(4,"div",15),d(5),i(),a(6,"div",16),d(7),i(),a(8,"div",17),d(9),C(10,"currency"),i(),a(11,"a",18),d(12,"Ver m\xE1s"),i()()),t&2){let e=r.$implicit;n(2),s("src",e.urlFoto||"assets/no-image.png",v)("alt",e.titulo),n(),s("ngIf",e&&(e.estado==="Aprobado"||e.estado==="APROBADO"||(e.estado==null?null:e.estado.nombre)==="Aprobado"||(e.estado==null?null:e.estado.nombre)==="APROBADO"||(e.estado==null?null:e.estado.estado)==="Aprobado"||(e.estado==null?null:e.estado.estado)==="APROBADO")),n(2),l(e.titulo),n(2),l(e.descripcion),n(2),b("Precio: ",P(10,7,e.precio,"USD","symbol","1.0-0"),""),n(2),s("routerLink",_(12,z,e.id))}}function R(t,r){if(t&1&&(a(0,"div",9),p(1,B,13,14,"div",10),i()),t&2){let e=g();n(),s("ngForOf",e.products)}}var T=class t{constructor(r,e,o){this.http=r;this.authService=e;this.userService=o}products=[];loading=!0;error=null;ngOnInit(){return f(this,null,function*(){this.loading=!0,this.error=null,this.products=[];try{let r=this.authService.getToken();console.log("[UserProducts] Token en ngOnInit:",r);let e=this.authService.getUserInfo();console.log("[UserProducts] userInfo extra\xEDdo:",e);let o=e?.email||Array.isArray(e?.emails)&&e.emails[0]||void 0;if(console.log("[UserProducts] Email extra\xEDdo:",o),!o)throw new Error("User email not found.");let m=yield this.userService.getUsuarioIdPorCorreo(o);if(console.log("[UserProducts] id obtenido para consulta:",m),!m)throw new Error("User id not found.");if(!r)throw new Error("No token available.");let u=yield fetch(`${M.publicacionesApiUrl}/publicaciones/autor/${m}`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!u.ok)throw u.status===401?new Error("No autorizado. Debe iniciar sesi\xF3n."):new Error("Error al obtener los productos.");this.products=yield u.json()}catch(r){console.error("[UserProducts] Error en ngOnInit:",r),this.error=r.message||"Error cargando productos."}finally{this.loading=!1}})}static \u0275fac=function(e){return new(e||t)(c(U),c(k),c(A))};static \u0275cmp=x({type:t,selectors:[["app-user-products"]],decls:7,vars:4,consts:[[1,"users-list-card"],[1,"users-list-title"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","no-products",4,"ngIf"],["class","products-grid",4,"ngIf"],[1,"loading"],[1,"error"],[1,"no-products"],[1,"products-grid"],["class","product-card",4,"ngFor","ngForOf"],[1,"product-card"],[1,"product-img-container"],[1,"product-img",3,"src","alt"],["class","ticket-verde-imagen",4,"ngIf"],[1,"product-title"],[1,"product-description"],[1,"product-price"],[1,"see-more-btn",3,"routerLink"],[1,"ticket-verde-imagen"]],template:function(e,o){e&1&&(a(0,"div",0)(1,"h2",1),d(2,"Mis Productos"),i(),p(3,D,2,0,"div",2)(4,F,2,1,"div",3)(5,N,2,0,"div",4)(6,R,2,1,"div",5),i()),e&2&&(n(3),s("ngIf",o.loading),n(),s("ngIf",o.error),n(),s("ngIf",!o.loading&&!o.error&&o.products.length===0),n(),s("ngIf",!o.loading&&!o.error&&o.products.length>0))},dependencies:[I,O,w,y,E,S],styles:[".users-list-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;box-shadow:0 4px 24px #1976d21a;padding:2.5rem 2rem;margin:2.5rem auto;max-width:98vw;width:100%}.users-list-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#1a237e;margin-bottom:2rem;text-align:left}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%], .no-products[_ngcontent-%COMP%]{text-align:center;margin:2rem 0;font-size:1.1rem}.error[_ngcontent-%COMP%]{color:#d32f2f;background:#ffebee;padding:1rem;border-radius:4px;margin-bottom:1rem;border-left:4px solid #d32f2f}.products-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:32px;padding:0 0 32px}.product-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #22314a12;display:flex;flex-direction:column;align-items:center;padding:18px 12px 20px;transition:box-shadow .2s}.product-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #22314a21}.product-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-bottom:.5rem;color:#22314f}.product-description[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:.5rem;color:#444}.product-price[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#4f46e5}.see-more-btn[_ngcontent-%COMP%]{display:block;width:100%;background:#22314a;color:#fff;border:none;border-radius:8px;padding:12px 0;font-size:1.1rem;font-weight:600;cursor:pointer;text-align:center;margin-top:1rem;text-decoration:none;transition:background .2s}.see-more-btn[_ngcontent-%COMP%]:hover{background:#1a2536;color:#fff;text-decoration:none}.product-img[_ngcontent-%COMP%]{max-width:120px;max-height:120px;border-radius:8px;object-fit:cover;margin-bottom:.7rem;display:block;margin-left:auto;margin-right:auto}@media (max-width: 1100px){.products-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 700px){.products-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{T as UserProductsComponent};
